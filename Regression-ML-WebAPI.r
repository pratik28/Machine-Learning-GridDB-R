# importing packages
library(httr)
library(xml2) 
library(readr) 
#library(rjson) 
library(jsonlite) 
library(tidyverse)
#library(caret)
library(leaps)
library(caTools) 
library(quickpsy) 

#Check if the GridDb cluster is accessible via secure Web API   
# base_url = "https://cloud1.griddb.com/trialxxxx/griddb/v2/gs_clustertrialxxxx/dbs/pratik" , i.e. https://[host]/griddb/v2/[clustername]/dbs/[databasename] 

my_base_url =  "https://cloud1.griddb.com/trial1602/griddb/v2/gs_clustertrial1602/dbs/r_blog" 
r <- GET(
	url = "https://cloud1.griddb.com/trial1602/griddb/v2/gs_clustertrial1602/dbs/r_blog/checkConnection" , 
   add_headers("Content-Type" = "application/json; charset=UTF-8" ) ,      
    config = authenticate("pratik", "pratik"), 
    encode = "json" 
  )
print(r)  

#Construct a data object to hold the request body (i.e., the container that needs to be created)  

my_data_obj = '{   	"container_name":"HCC_Data4"  ,  	"container_type":"COLLECTION" ,    	"rowkey": false,    "columns": [  { "name": "Gender"  ,"type": "FLOAT" },{ "name": "Symptoms"  ,"type": "FLOAT" },  { "name": "Alcohol"  ,"type": "FLOAT" }, { "name": "Hepatitis_B_Surface_Antigen"  ,"type": "FLOAT" },{ "name": "Hepatitis_B_e_Antigen"  ,"type": "FLOAT" },{ "name": "Hepatitis_B_Core_Antibody"  ,"type": "FLOAT" },{ "name": "Hepatitis_C_Virus_Antibody"  ,"type": "FLOAT" }, { "name": "Smoking"  ,"type": "FLOAT" },{ "name": "Diabetes"  ,"type": "FLOAT" }, { "name": "Obesity"  ,"type": "FLOAT" },{ "name": "Hemochromatosis"  ,"type": "FLOAT" }, { "name": "Arterial_Hypertension"  ,"type": "FLOAT" },{ "name": "Chronic_Renal_Insufficiency"  ,"type": "FLOAT" },{ "name": "Nonalcoholic_Steatohepatitis"  ,"type": "FLOAT" }, { "name": "Esophageal_Varices"  ,"type": "FLOAT" },{ "name": "Splenomegaly"  ,"type": "FLOAT" },{ "name": "Liver_Metastasis"  ,"type": "FLOAT" },  { "name": "Age_at_diagnosis"  ,"type": "FLOAT" },{ "name": "Packs_of_cigarets_per_year"  ,"type": "FLOAT" },{ "name": "Performance_Status" ,"type": "FLOAT" },   { "name": "Encefalopathy_degree"  ,"type": "FLOAT" },{ "name": "Ascites_degree"  ,"type": "FLOAT" }, { "name": "International_Normalised_Ratio"  ,"type": "FLOAT" },{ "name": "Alpha_Fetoprotein"  ,"type": "FLOAT" },   {"name": "Haemoglobin"  ,"type": "FLOAT" },{ "name": "Mean_Corpuscular_Volume"  ,"type": "FLOAT" }, { "name": "Leukocytes"  ,"type": "FLOAT" },{ "name": "Platelets"  ,"type": "FLOAT" },   { "name": "Albumin"  ,"type": "FLOAT" },{ "name": "Total_Bilirubin"  ,"type": "FLOAT" }, { "name": "Alanine_transaminase"  ,"type": "FLOAT" },{ "name": "Alkaline_phosphatase"  ,"type": "FLOAT" }, { "name": "Total_Proteins"  ,"type": "FLOAT" },{ "name": "Creatinine"  ,"type": "FLOAT" }, { "name": "Number_of_Nodules"  ,"type": "FLOAT" },{ "name": "Direct_Bilirubin"  ,"type": "FLOAT" }, { "name": "Iron"  ,"type": "FLOAT" },{ "name": "Oxygen_Saturation"  ,"type": "FLOAT" }, { "name": "Ferritin"  ,"type": "FLOAT" },{ "name": "Class"  ,"type": "FLOAT" }, { "name": "Alive"  ,"type": "FLOAT" }   ]    } ' 
  
#Set up the GridDB WebAPI URL
container_url = "https://cloud1.griddb.com/trial1602/griddb/v2/gs_clustertrial1602/dbs/r_blog/containers"
#Lets now invoke the POST request via GridDB WebAPI with the headers and the request body 
 r <- POST(container_url, 
       add_headers("Content-Type" = "application/json; charset=UTF-8" ) ,      
       config = authenticate("pratik", "pratik"), 
       encode = "json", 
       body= my_data_obj) 

print("After container create")	  
# Populate the container with rows from JSON or CSV , since some platforms may remove the newline from our array format JSON,
# we directly use JSON array below, but you can also read from your file system as shown in the next line. 
# HCC_Data4_JSON <- fromJSON("../data/hcc_data.json") 

HCC_Data4_JSON <- '[ 
[1,0,1,0,0,0,0,1,1,0,1,0,0,0,1,0,0,67,137,4,15,0,1,1.53,95,13.7,106.6,4.9,99,3.4,2.1,183,150,7.1,0.7,1,3.5,0.5,0,0,0], 
[0,0,0,0,0,0,1,0,1,0,0,1,0,0,1,0,0,62,0,9,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1.8,0,0,0,0], 
[1,0,1,1,0,1,0,1,0,0,0,1,1,0,0,0,1,78,50,6,50,2,1,0.96,5.8,8.9,79.8,8.4,472,3.3,0.4,202,109,7,2.1,5,13,0.1,28,6,16], 
[1,1,1,0,0,0,0,1,1,0,0,1,0,0,0,0,1,77,40,6,30,0,1,0.95,2440,13.4,97.1,9,279,3.7,0.4,94,174,8.1,1.11,2,15.7,0.2,0,0,0], 
[1,1,1,1,0,1,0,1,0,0,0,1,1,0,0,0,0,76,100,5,30,0,1,0.94,49,14.3,95.1,6.4,199,4.1,0.7,173,109,6.9,1.8,1,9,0,59,15,22], 
[1,0,1,0,0,0,0,0,0,1,0,0,0,0,1,1,0,75,0,9,0,1,1,1.58,110,13.4,91.5,5.4,85,3.4,3.5,242,396,5.6,0.9,1,10,1.4,53,22,111], 
[1,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,49,0,10,0,0,1,1.4,138.9,10.4,102,3.2,42000,2.35,2.72,143,211,7.3,0.8,5,2.6,2.19,171,126,1452], 
[1,1,1,0,0,0,0,1,1,0,0,0,0,0,0,1,0,61,0,9,20,3,1,1.46,9860,10.8,92,3,58,3.1,3.2,184,300,7.1,0.52,2,9,1.3,42,25,706], 
[1,1,1,0,0,0,0,1,1,0,0,1,0,0,0,1,0,50,100,5,32,1,1,3.14,8.8,11.9,107.5,4.9,70,1.9,3.3,115,63,6.1,0.59,1,6.4,1.2,85,73,982], 
[1,1,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,43,100,5.5,0,0,1,1.12,1.8,11.8,87.8,5100,193000,4.2,0.5,256,303,7.1,0.59,1,9.3,0.7,0,0,0], 
[1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,0,41,0,11,0,0,1,1.05,100809,13,94.2,5.7,196,4.4,3,494,236,7.6,0.8,5,0,1.1,0,0,0], 
[1,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,74,0,9,0,0,1,1.33,86,15.7,96.7,4,61,3.7,1.3,113,154,0,7.6,5,1.9,0.3,144,41,277], 
[1,0,1,0,0,0,0,1,1,0,0,1,0,0,0,1,0,66,0,8,30,0,1,1.53,60,13.3,90.1,5.5,207000,4.4,8.5,35,74,8.5,0.73,1,5,0.8,0,0,0], 
[1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,56,0,11,0,0,1,1.2,6.6,13.7,93.8,4.1,91000,4.5,1,205,70,8.8,0.88,1,22,0,82,24,0], 
[1,0,1,0,0,0,0,0,1,0,0,1,0,0,1,1,0,63,0,10,0,2,2,1.25,29,13.5,93,6,128,3.15,10.5,165,163,7.3,1.07,4,4.5,4.5,197,84,302], 
[0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,41,100,4.5,0,1,1,1.61,4.6,10.2,89.6,5.5,161,3.1,3.1,163,176,5,0.8,2,2.6,1.3,25,13,60], 
[1,0,1,0,0,0,0,1,1,0,1,0,0,0,0,1,0,72,0,8,0,3,2,2.14,60,12.1,99.2,5,58,2.4,9.8,201,235,6.2,0.96,2,2,2.9,136,95,767], 
[1,1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1,60,100,5,60,2,1,1.05,9.2,10.3,103.7,5.4,159,3.8,0.5,459,146,5.4,1.23,5,13.5,3.8,187,58,443], 
[1,0,1,0,0,0,0,1,0,0,0,1,1,0,1,0,0,64,200,3,78,1,1,1.13,8.8,14.9,94.8,6.3,137,4.3,0.9,82,180,6.5,4.95,1,5.4,0.9,144,49,295], 
[1,1,1,0,0,0,0,0,0,0,0,1,0,0,1,1,0,75,500,0,0,0,1,1.44,34,15.9,103.4,9600,101000,3.4,3.4,260,147,6.3,0.9,5,2.3,1.6,67,34,774], 
[1,0,1,0,0,0,0,1,0,1,0,0,0,0,1,1,0,71,200,3,60,0,1,1.29,19.6,11.7,101,2600,109000,3.6,1.7,23,141,7.3,0.68,1,2.5,0.7,152.6,0,76.9], 
[1,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,73,80,5,47,0,1,1.06,3.9,16.4,90.7,7.8,187,4.5,1,52,97,6.3,0.75,1,6.8,0.2,87,26,84], 
[1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,66,180,3,0,1,1,1.27,1975,10.8,86.5,9100,154000,3.1,1.2,869,562,69,1.14,5,3.8,0.5,112,73,1001], 
[1,1,1,0,0,0,0,1,1,0,0,1,0,0,1,1,1,64,200,3,60,1,1,4.82,185,10.7,88.1,5,194000,3.6,3.8,879,396,7,0.53,5,15,1.6,0,0,0], 
[1,1,1,0,0,1,0,1,0,0,0,1,0,0,0,0,1,84,150,4,0,4,1,1.74,5532,13.1,111,3.5,351000,2.4,1.3,108,311,5.6,0.95,1,10,0.7,0,0,0], 
[1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,80,100,5,0,2,1,1.33,13327,13.7,94.3,5.2,110,3.1,1.6,465,233,8.4,0.79,5,0,0.7,93,31,79], 
[1,1,1,0,0,0,1,1,0,0,0,0,0,0,1,1,0,45,50,7,16,1,1,1.38,0,13.6,98.4,4.3,99000,3.3,1.3,252,172,8.1,0.83,1,5,0.7,0,0,0], 
[1,0,1,1,0,1,0,0,0,0,0,0,0,0,1,1,0,57,0,11,0,0,1,1.37,5.9,15.5,88.2,4.9,113,4.5,3.2,34,111,0,0,2,4,1,180,56,0], 
[1,0,1,0,0,0,0,1,1,0,0,0,0,0,1,1,0,61,60,6,67.5,1,1,1.3,3255,12.2,89.5,4.4,108,3,1.1,419,293,7.7,0.67,2,6.5,0.4,94,27,70], 
[1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,20,0,9,2,1,1,1.21,1.9,9.9,83.4,8.1,556,3.2,1.8,599,974,7.7,0.7,5,0,1.1,22,7,369], 
[1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,0,60,20,8,8,2,1,1.19,11,13.1,87.9,7.8,212,3.5,0.7,143,158,8.2,0.71,1,16,0,0,0,0], 
[1,0,1,0,0,0,0,1,1,0,0,1,0,0,1,1,0,62,120,5.5,0,0,1,1.44,1237,12.2,94,6200,93000,4.2,1,191,129,58,1.06,5,7,0,75,24,239], 
[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,67,100,6,0,0,1,1.32,7.7,15.7,96.1,9.1,268000,3.4,0.6,49,135,8.2,0.9,2,0,0,0,0,0], 
[1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,77,0,9,0,0,1,1.24,266,13.7,97.7,13000,170000,4.2,0.5,232,227,16.8,1.72,1,5.9,0,0,0,0], 
[1,1,1,1,0,1,0,0,0,0,0,1,0,0,1,0,0,62,0,8,0,0,1,1.28,5689,14.3,99.6,6.8,77,3.8,1.7,184,184,6.9,0.89,2,3,0.77,0,0,0], 
[1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,76,0,9,0,0,1,0.96,14.2,14.8,98.5,4.95,187,4.2,0.77,89,113,6.7,0.95,3,8.8,0.37,0,0,0], 
[1,1,1,0,0,0,0,0,1,0,0,1,0,0,0,1,0,73,75,6,0,4,1,2,3.1,13.1,109.3,44.6,60,2.3,7.8,180,127,5.6,0.88,5,3.1,3.3,98,89,870], 
[1,1,1,0,0,0,0,1,1,0,0,1,0,0,0,0,0,84,200,2,30,1,1,1.24,633,13,96.5,7200,143000,2.3,1.1,322,209,6.7,1.4,5,4.9,0.2,57,25,134], 
[1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,70,100,4.5,0,0,1,1.09,5.4,14.9,105,7.2,230000,4.2,1.3,174,92,7.3,0.8,2,6,0.3,0,0,0], 
[1,1,1,1,0,1,1,0,0,0,0,1,0,0,0,0,1,59,200,3,0,0,1,1.42,479,11.3,82.2,9500,160000,3.1,1.4,924,288,7.9,0.98,5,17,0.6,0,0,0], 
[0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,71,0,12,0,0,1,1.18,19,13.9,88.3,6.86,201000,4.4,0.8,123,104,8.5,0.74,2,3.3,0.3,143,50.18,120], 
[1,0,0,0,0,1,0,0,1,1,0,1,0,0,0,0,0,66,0,11,0,0,1,1.21,2.8,15.7,92.7,15.4,188000,4.1,0.7,196,68,6.5,1.3,1,5,0.3,0,0,0], 
[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,86,0,9,0,3,1,1.2,185203,15,85.5,8.8,183,3.6,1,442,278,7.2,0.86,5,15.8,0.3,21,9,279], 
[1,0,1,0,0,0,0,0,0,1,0,0,0,1,1,1,0,71,75,6,0,0,1,1.17,5,15.1,104.1,4.3,65000,3.8,2.5,239,56,7.3,0.7,1,2,0.2,0,0,0], 
[0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,52,0,9,0,0,1,1.71,237,15.6,98.1,4.3,88,3.2,2.2,72,97,6.7,0.86,5,2.2,0.5,0,0,0], 
[1,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,60,0,8,0,0,1,1.18,2.8,16.6,93.8,8300,167000,4.9,0.9,62,68,8.3,0.72,1,2.3,0,0,0,0], 
[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,12,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0], 
[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,66,0,13,0,1,1,1.64,16,14,102.9,11.5,277000,3.1,6.8,795,595,7.2,0.79,1,2.3,4.1,63,34,888], 
[1,1,0,0,0,0,0,1,1,0,0,1,1,1,0,0,0,80,0,9,80,0,1,1.33,163,10.6,96.2,9900,280000,3.3,1,236,171,7.5,1.38,1,19,0,45,21,802], 
[1,0,1,0,0,1,0,1,0,0,0,0,0,0,1,1,0,58,0,10,40,0,1,1.49,20,15,96.7,9,78,4.6,2.1,137,109,7.6,0.8,1,2,0.4,184,59,905], 
[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,27,0,11,0,2,1,0.97,46,10.5,78.7,20.9,251,2.4,0.3,91,539,5,0.38,5,20,0.3,0,0,0], 
[0,0,1,0,0,0,1,0,1,0,0,0,0,0,0,1,1,73,100,5,0,0,1,1.2,41470,12.6,91.4,12,275000,3.11,2.3,394,350,7.3,1.7,5,0,0.8,84,37,497], 
[1,1,1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,73,0,9,0,0,1,1.33,4.7,11.8,80.2,3.7,99,4.1,0.7,67,62,7.4,0.77,1,2.3,0,104,37,635], 
[1,0,1,0,0,0,0,0,0,0,1,0,0,0,1,1,0,50,0,8,0,0,1,1.65,7.3,15.3,93.7,3500,57000,0,1.4,294,130,0,0.76,2,2,0.3,184,2.26,59], 
[1,1,1,0,0,0,1,1,0,0,0,0,0,0,1,1,0,51,100,4,30,3,1,1.35,1898,12.4,95.1,9.8,216,2.7,8.2,433,397,6.7,0.82,1,2.1,5.5,56,27,742], 
[0,1,0,0,0,0,1,0,1,0,0,1,0,0,0,0,1,78,0,9,0,1,1,1.32,77,10.8,88,6000,174000,3.2,0.9,171,923,5.4,1.31,3,15.4,0,0,0,0], 
[1,1,1,0,0,0,0,1,1,0,0,1,0,0,0,0,0,81,100,5,10,2,1,3.56,2.7,7.3,90.8,2.42,159000,3.4,0.5,80,55,6.2,0.85,1,2.2,0,22,6,48], 
[1,0,1,0,0,0,0,1,1,0,0,1,0,0,1,0,0,65,100,4,0,0,1,1.24,2.6,10.3,83,6.1,1.71,3.9,0.8,77,120,7,0.58,1,4.7,0.85,32,10,18], 
[1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,72,70,6,0,3,2,1.96,12,10.9,102,4.1,99,1.9,4.2,470,263,7,0.99,1,8.5,1.9,44,20,176], 
[1,1,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,82,0,9,0,0,1,1.11,0,18.7,92.4,6900,270000,4,0.9,115,103,6.8,1.24,1,10,0,0,0,0], 
[1,1,0,1,0,1,0,1,0,0,0,0,0,0,1,1,0,76,0,8,50,1,1,1.28,608,12.6,100,5.4,129,4,1.7,125,100,7.5,0.9,5,3.5,0.5,0,0,0], 
[1,1,1,0,0,1,1,1,0,0,0,0,0,0,1,1,0,56,100,4,40,0,2,1.46,41,14.6,100.8,5.5,42000,3.1,3.7,101,207,6.3,0.69,1,3,1.9,224,95,363], 
[0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,1,0,68,0,9.5,30,2,1,1.94,0,11.5,97.4,5700,77000,2.7,4.9,46,178,6.1,0.62,1,4.6,2.2,0,0,0], 
[1,1,1,0,0,0,0,1,1,0,0,1,0,0,1,1,0,72,300,1,0,3,1,1.57,2,12.6,96.6,2.9,76000,3.5,2.4,110,166,0,0.77,1,2,0.5,0,0,0], 
[1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,66,0,8,0,0,1,1.29,7,12.1,95.1,3.8,77000,3.8,1.4,194,161,6.7,0.71,1,10,0.5,0,0,0], 
[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,40,0,7,0,2,1,1.17,3.1,15.1,86,8.9,275000,2.8,1.3,23,104,5.4,0.6,5,7.8,0.2,46,18,0], 
[1,0,1,0,0,1,0,1,0,0,0,0,0,0,0,1,0,68,60,7,0,0,1,1.34,13,15.6,93,4.9,91000,4.54,1.4,275,113,7.8,0.55,2,6.2,0.3,94,33,393], 
[1,1,1,0,0,1,0,0,0,0,0,0,0,0,1,1,0,63,100,5,0,0,1,2.07,1.7,9.5,99.2,3300,79000,2.1,1.6,134,113,37,0.4,1,2.7,0.2,94,37,48], 
[1,1,1,0,0,0,0,0,1,0,0,0,0,0,0,1,1,72,100,6,0,0,1,1.3,249,12.7,100.3,5.5,114,3.1,3.9,40,108,5.8,0.9,5,8,1.2,37,17,419], 
[0,1,1,0,0,1,0,0,0,1,0,0,1,0,0,0,0,88,80,6,0,2,2,1.27,66,10.9,97.3,8.9,270,2.7,2.1,179,260,5.9,0,5,3,1.3,15,17,639], 
[0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,23,0,13,0,0,1,1.17,358,12.7,74,2.2,51,2.9,2.8,54,94,4.9,0.2,2,5.4,0.8,50,16,20], 
[1,1,1,0,0,0,0,1,0,0,0,0,0,1,0,0,1,59,75,7.5,44,3,2,1.01,1810346,13,102.1,8300,433000,3.4,1.9,1575,417,6.5,0.64,5,15,1.1,0,0,0], 
[1,1,1,0,0,0,0,1,0,0,0,1,0,0,0,1,1,82,50,8,48,2,1,1.53,33502,14.4,101.1,11.6,109,3.1,2.3,177,1.28,6.7,1.5,5,4,0.8,26,15,227], 
[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,67,0,8,0,0,1,0.94,20,13,92,6.9,222000,3.7,0.6,1390,684,7.1,0.81,5,0,0,0,0,0], 
[1,1,1,0,0,0,0,1,0,0,0,1,0,0,1,1,0,61,0,8,15,0,1,1.15,2.5,14.9,92.3,6,159000,3.8,1,74,101,7.4,1.1,5,7.5,0.3,61,0,255], 
[1,1,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,61,100,5,0,0,1,1.92,2269,12.1,119,5.1,80000,0,9.6,199,174,0,0.99,1,7.6,4.6,178,90,960], 
[1,1,1,0,0,0,0,0,0,0,0,1,0,0,1,0,0,67,0,9.5,0,2,1,3.16,4181,9.1,103.6,5.1,128000,3,2.2,115,165,7.7,0.83,1,4.5,1.2,72,29.5,355], 
[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,78,80,7,0,0,1,1.45,5.1,14.4,100.2,7.1,77000,4.1,0.9,540,114,7,1.09,5,0,0,0,0,0], 
[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,52,80,6.5,0,3,1,1.34,345,9.8,81.8,13.6,561,2.6,0.5,23,88,5.6,0,5,4.7,0.5,19,8,141], 
[1,0,1,0,0,0,1,1,0,0,0,0,0,0,1,1,0,51,100,6,34.5,2,2,2.08,2.9,10.4,91.1,5.8,91000,2.4,16,109,190,5.9,0.9,0,0,9.6,0,0,0], 
[1,1,1,0,0,0,0,0,1,0,0,1,1,0,0,1,1,74,0,9,0,3,2,1.32,2.5,12.6,83.7,9.8,102000,3.3,1.2,196,204,7.3,1.1,5,0,0.5,0,0,0], 
[1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,56,100,5,0,1,2,1.63,5.04,15.8,99,5.8,75000,3.5,4.6,193,165,6.6,0.7,1,6,1.7,200,87,316], 
[1,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,64,100,5,0,1,1,1.71,3.7,14.8,104.3,5.8,56000,2.7,2.6,311,280,8,0.8,2,3,1.4,0,1.52,859], 
[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,83,100,6.5,0,2,1,1.48,2.6,12.7,106,3.8,80,2.9,3.4,156,207,7.2,0,2,4.1,1.4,105,69,221], 
[1,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1,0,57,0,10,0,0,0,1.1,2.9,16.4,94.8,4.6,94000,4.1,1.1,88,85,7.9,1.05,1,5.5,0.3,0,0,0], 
[1,1,1,0,0,1,0,1,0,1,0,0,0,0,0,1,0,58,0,10,10,1,2,1.47,20,13.9,100.8,4,112000,3,2.9,124,244,6.3,0.8,2,6.8,0.7,181,99,108], 
[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,71,0,11,0,1,1,1.08,2.79,12.6,83.9,7100,284000,0,0,70,213,0,0.48,5,0,0,26,8,0], 
[1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,1,0,52,0,12,33,0,1,0,42,15.8,97.9,4.2,142000,4.2,0.5,38,70,7.5,0.77,3,1.5,0,120,35,30], 
[1,1,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,74,100,4.5,0,0,1,1.37,457,11.7,70.6,5.7,138000,4.1,2.1,33,90,9.7,1.6,5,5.6,0.9,13,3,28], 
[1,0,1,0,0,1,0,1,0,0,0,0,0,0,1,1,0,61,0,9,50,1,2,1.23,0,9.5,90,7.6,38000,2.2,1.5,993,474,3.9,2.69,1,2,1,0,0,0], 
[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,69,100,6,0,2,1,1.41,123,10.1,89.5,2.3,89000,4,4.3,75,177,6.8,0.7,3,3.5,1,37,11,173], 
[1,0,1,0,0,0,0,0,1,0,0,1,0,0,1,1,0,65,0,11,0,0,1,1.22,8.7,14.6,95.1,6.7,142000,4.2,1.3,346,120,7.8,0.83,0,0,0.3,184,65,423], 
[1,1,1,0,0,1,0,0,1,0,0,1,1,0,0,0,0,79,70,6.5,0,3,1,1.01,226,11.5,95.6,6.3,108,4.2,1,667,222,6.2,3.13,1,8.8,0.2,0,0,0], 
[1,1,1,0,0,0,0,1,1,1,0,0,0,0,0,0,1,69,200,3,60,1,1,1.39,2159,13.1,90.6,10400,261000,3.6,1.9,552,335,7.1,0.68,5,0,0.6,0,0,0], 
[1,0,1,0,0,0,0,1,1,0,0,1,1,0,0,0,0,87,100,5,50,0,1,1.09,48,12.6,97.6,4.9,169000,4.2,0.8,86,91,6.9,1.9,5,2,0,53,21,278], 
[1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,78,0,9,0,1,1,1.6,2.4,9.5,85.8,6900,228000,3.5,0.6,44,124,6.8,1.6,1,5.5,0,15,7,810], 
[1,1,1,0,0,0,1,0,1,0,0,1,0,0,0,0,0,71,0,8,0,1,1,1.11,5,9.1,90.9,6.36,307000,2.47,0,339,254,5.5,1.18,3,6.3,0,0,0,0], 
[1,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,58,0,9,0,0,1,1.64,64,14.1,103.6,4.5,68,2.9,3.3,51,137,6.8,0.67,4,4.7,1.1,0,0,0], 
[1,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,73,0,8,0,0,1,1.23,5.5,13.1,89.6,6.1,160000,3.2,0.8,90,92,6.3,0.86,5,0,0,93,25,29], 
[1,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,73,0,9,0,2,1,1.67,8.5,13,102.3,24.8,133000,2.7,9.5,351,66,6.1,1.2,5,7,5.5,0,0,0], 
[1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,93,0,11,0,2,1,1.16,2785,12,94.4,7.9,78000,2.6,3.5,339,297,5.7,2.19,5,0,1.5,55,33,256], 
[1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,1,1,52,0,12,0,1,1,1.04,6574,13.5,98,4800,77000,3.5,28.9,464,262,6.9,1.2,5,4,19.5,121,27,749], 
[1,1,1,0,0,0,0,0,0,0,0,1,0,0,1,1,0,64,70,7,0,2,1,1.55,5.7,13.9,99.7,5200,124000,2.1,0.8,203,110,5,0.56,3,2.4,0,92,56,489], 
[1,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,63,0,11,0,4,3,1.93,0,13.5,93.3,8190,406000,2.9,40.5,403,670,6.3,4.82,5,0,29.3,0,0,0], 
[1,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,64,0,10,50,1,1,1.17,39,12.6,93.8,4900,144000,3.8,1,277,312,78,1.01,1,15,0,87,25,81], 
[1,1,1,0,0,0,0,0,0,0,0,1,1,0,1,1,0,67,0,9,0,3,1,1.48,2.5,14.3,101.5,5,120,2.2,1.2,222,97,5.2,2.82,3,2.4,0.3,92,56,48.9], 
[1,1,1,0,0,1,1,1,0,0,0,0,0,1,0,1,0,50,80,8,1,0,1,1.18,32,14,90.1,5.2,121000,4.2,0.4,147,174,8.6,0.9,5,3,0,26.4,54,2230], 
[1,1,1,0,0,0,0,0,1,0,0,0,1,0,1,1,0,79,75,8,0,3,1,1.32,7.6,5,69.5,3800,96000,3.7,0.5,76,86,6.3,2.68,1,10,0,9,3,490], 
[1,1,1,0,0,0,0,0,1,1,0,1,0,1,0,0,1,85,100,5,0,1,1,1.25,173,11.3,103.9,6200,176000,2.4,1.7,80,163,6.1,0.67,5,20,0.5,131,78,1316], 
[0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,62,0,8.5,0,0,1,1.54,2.3,12.1,89.7,4.5,97000,2.7,1.4,72,120,4.3,0.61,5,4,0.7,0,0,0], 
[1,1,1,1,0,1,0,1,0,0,0,1,0,0,1,1,1,74,200,4,30,2,2,1.26,114,14.9,104.5,4.3,90000,3.2,4.8,148,166,7.2,0.48,5,12.6,1.8,161,96,297], 
[1,1,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,56,90,5,0,2,1,1.87,173,11.1,105.5,6.1,51000,3.1,32.3,127,188,5.4,1.29,5,0,22.1,0,0,0], 
[1,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,74,100,5,0,0,1,1.36,18,15.3,90.9,4.9,81000,4.2,1.7,97,109,7.3,1.02,1,3.5,0.3,0,0,0], 
[1,1,0,1,0,1,0,1,0,0,0,0,0,0,1,1,1,62,0,10,7.5,1,1,1.45,42,16.2,99.1,5.001,77000,4.1,1.3,279,158,7.7,0.88,2,7.4,0.3,0,0,0], 
[1,1,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,60,100,4,0,3,3,1.87,28274,10.3,94.7,11.1,109000,2.4,5.7,55,128,7,1.3,1,1.5,1.9,51,18,56], 
[1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,55,100,4.5,43,0,1,1.23,736,14,88.2,4.68,286000,4.7,0.8,649,629,8.4,0.71,5,9.1,0.3,0,0,0], 
[1,1,1,0,0,0,0,1,1,0,0,1,0,0,1,1,0,57,96,5,60,0,1,1.17,1009,13.8,93.2,3100,137000,3,0.7,343,235,0,0.79,2,20,0,0,0,0], 
[1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,0,63,120,5,0,4,3,2.42,22475,12,111.4,9.9,70000,3.28,19,54,146,8,3.23,1,0,9.7,106,67,2165], 
[1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,63,0,9,0,0,1,1.28,5.2,14.6,96.1,6.1,194000,4.2,7.9,816,79,7.7,1.02,1,3,0,0,0,0], 
[1,0,1,0,0,0,0,1,0,0,0,0,0,0,1,0,0,79,180,3,23,0,1,1.46,5.2,14.9,103.8,4500,53000,3.2,1.4,263,239,8.1,0.72,1,1.5,1,0,0,0], 
[1,1,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,63,0,8,0,1,1,1.14,14177,10.2,96.1,6000,109000,2.6,4.9,833,980,7.5,0.78,5,9,2.8,0,0,0], 
[1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,59,100,4,0,0,1,1.94,3.1,10.8,102.8,5300,97000,3.6,1.1,663,433,6.5,0.87,2,3.2,0.4,52.5,37,856], 
[1,1,1,0,0,1,1,1,0,0,0,0,0,0,1,1,1,51,75,4.5,52.5,2,1,1.56,50655,9.8,85.6,3900,132000,2.6,2.6,503,363,7.3,0.55,1,4,1.5,40,12,57], 
[1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,74,0,9,0,0,1,1.11,1.2,15.1,83.8,5.2,178000,4.7,0.5,45.3,151,6.4,1.5,1,8.3,0,88,27,90], 
[1,1,1,0,0,1,1,1,0,0,1,0,0,0,1,0,0,62,0,8,0,2,1,1.08,657,11.8,89.2,9400,211000,3.2,0.8,646,466,7.3,0.7,1,8.3,0,0,0,579], 
[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,76,100,4.5,0,4,2,1.2,421500,14.3,89.5,9.8,309000,3.1,1.5,291,217,6.3,0.7,1,20,0.5,52,17,832], 
[1,0,0,0,0,0,1,0,1,0,0,0,0,0,1,1,0,73,0,9,0,0,1,1.2,472,15.6,88.4,5.5,83000,4,2.4,249,117,7.2,0.69,1,13,0.7,0,0,0], 
[1,0,1,0,0,0,0,0,1,0,0,1,0,0,0,1,0,76,0,8,0,3,2,1.66,77,12.3,104.2,2900,60000,3.2,2.8,311,182,6.2,0.77,2,4.3,1,93,47,307], 
[1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,72,0,10,510,2,1,1.13,2.1,12.6,95.1,8.7,254000,3.68,0.7,161,127,6.9,1.11,2,4.3,0,28,10,308], 
[0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,77,75,5,0,2,2,1.07,2,11.6,83.5,9,318000,3.89,0.9,319,171,7.1,0.66,2,5.8,0,0,0,0], 
[0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,1,75,0,11,0,2,1,1.22,4.2,14.9,87.4,15.4,179000,3.5,0.6,196,150,5.4,0.7,5,17.5,0.3,0,0,0], 
[0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,55,100,5,0,2,2,2.5,7.5,11.3,119.6,13.1,135000,3.2,8.6,82,147,6.5,1,5,2.6,3.8,0,0,0], 
[0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,1,0,72,0,11,0,0,1,1.21,152,10.9,99.6,7.3,93000,3.2,1.3,427,106,7.1,6.1,2,9,0.7,0,0,0], 
[0,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,82,0,12,0,1,1,1.09,811,11.4,89.3,9.1,318000,3.4,0.8,739,587,7.2,2.14,5,16,0,14,5,149], 
[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,46,0,11,0,0,1,1.42,4.7,14.2,90.3,6690,268000,3.1,0.32,80,517,5.5,0.7,1,13,0.12,0,0,0], 
[0,1,0,0,0,0,0,0,1,1,0,1,0,1,0,0,1,71,0,13,0,1,1,1.24,2.6,13.3,96.4,7.8,280000,4.1,0.6,141,123,6.8,0.82,5,8.3,0,0,0,0], 
[0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,56,0,12,40,2,1,1.25,2089,15.4,91.6,10.9,175000,4.4,1.3,717,295,7.4,1.1,5,6,0.6,0,0,0], 
[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,78,0,13,0,0,2,1.03,18,13.2,89.5,2.6,136000,4.3,0.8,82,141,7.2,0.85,1,9.5,0,91,31,80], 
[0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,55,0,11,0,0,1,1.19,4.9,13.6,97.3,5400,133000,4.5,0.9,487,89,7.8,0.78,2,3.32,0,78,30,220], 
[0,1,1,0,0,1,1,1,1,1,0,1,0,0,0,0,0,76,0,11,12,2,1,0.94,240,14.7,102.3,9.9,267000,3.6,0.5,356,192,7.4,0.9,3,2,0.4,0,0,0], 
[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,43,0,10,0,0,1,1.25,180,12.2,87.6,7.2,130,3.5,0.5,229,302,7,0.6,5,9,0,0,0,206], 
[1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,71,0,10,0,0,1,1.47,15,13.3,89.7,5.7,154000,3.2,1,120,108,102,0.68,3,2,0,0,0,0], 
[1,0,1,0,0,0,1,0,1,1,1,0,1,0,1,0,0,67,70,5,0,0,1,1.02,24,16,98.8,6.6,96000,4.1,1.4,116,84,7.2,0.9,1,2.2,0.3,0,0,0], 
[1,0,1,0,0,0,0,1,1,1,0,0,0,0,1,1,0,67,0,10,40,0,1,1.798,9.4,11.2,102.4,4.1,60000,3.4,3.7,175,106,7.6,0.52,1,2.1,1.1,94,39,344], 
[1,0,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,51,0,9,37,0,1,1.26,7,14.9,106.3,6.4,122,3,1.5,272,93,6.4,1,3,2.9,0.4,124,51,642], 
[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,80,0,11,0,0,1,1,4.8,9.2,94,6.2,157000,3.88,0.76,983,141,0,1.1,1,15,0.33,0,0,0], 
[1,1,1,0,0,0,0,1,0,1,0,1,1,0,1,0,0,79,100,5,15,2,1,1.68,92421,14.3,72.2,13.3,459000,3.2,1.6,570,472,5.9,2.02,1,0,0.6,29,4,14], 
[1,0,1,0,0,0,0,0,1,1,0,1,0,0,1,1,0,75,0,9,0,0,1,1.71,5.2,11.1,106.9,2100,52000,3.3,2.6,94,117,7.1,0.79,1,3.5,1,0,0,0], 
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,81,0,8,0,0,1,1.18,16,13.3,94.3,4800,96000,3.8,1.2,75,105,7.6,0.53,1,2.4,0.3,0,0,0], 
[0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,25,0,9,0,2,1,0,1.5,0,0,0,0,0,0,0,0,0,0,1,6.6,0,0,0,0], 
[1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,36,0,11,0,0,1,1.12,3204,16.1,92,10.5,182,4.3,0.7,92,79,7.3,1,1,0,0.2,0,0,0], 
[0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,69,0,12,0,0,1,1.2,10,13.5,104.9,13.5,194,4,1,126,85,7.6,0.8,1,7,0.4,0,0,0], 
[1,1,1,0,0,0,1,1,1,0,0,0,1,0,1,1,1,47,250,2,18,1,1,1.39,695,11.1,93.9,5.4,88000,2.7,1,38,44,7,0.96,5,3.5,0,0,0,0], 
[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,87,0,8,0,3,1,1.2,33,9.7,91.6,10.1,277,3.8,2.4,468,338,7,1.13,1,15,1.3,0,0,0], 
[0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,0,36,0,9,0,0,1,1.52,615,11.7,99.7,5.6,70000,2.82,3,120,318,6.4,0.64,5,1.9,1,0,0,0], 
[1,1,1,0,0,0,0,1,0,0,1,0,0,0,0,1,0,64,75,4,25,3,2,1.63,1671,12.8,101.6,4.4,172000,3.44,5.8,92,139,7.6,0.9,3,9,2.9,111,94,1600], 
[1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,1,49,0,9.5,0,1,1,1.24,975,15.3,103,11.5,124000,3.5,1.2,561,266,7.5,0.77,1,2.3,0.6,180,70,1176], 
[1,0,1,0,0,0,0,1,0,0,0,1,0,0,1,1,0,62,0,9.5,20,0,1,1.41,1.7,14.7,97.2,6900,72000,3.5,1.3,67,97,7.3,0.76,1,3.5,0.3,0,0,0], 
[1,0,0,0,0,0,0,0,1,0,0,0,1,0,1,1,0,71,0,10,0,3,1,1.16,1713,8.2,94.2,6,209000,3.6,0.3,450,263,6.8,1.49,1,7.5,0,0,0,0], 
[1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,1,1,64,100,5,0,3,3,1.52,4.9,7.9,111.2,4.1,67000,2.43,1.9,69,73,4.8,0.77,5,3.2,0.7,40,18,283], 
[0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,40,0,9,0,0,1,0.84,0,15.4,109.2,9.3,184000,4.6,0.5,449,109,7.6,0.7,5,3,0,0,0,0], 
[0,1,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,68,0,8,0,2,1,1.33,4887,12.1,88.9,2.5,141,3,3.6,147,280,6.7,0.7,1,2.2,2.3,0,0,0], 
[1,0,1,0,0,0,0,1,1,1,0,1,1,0,0,0,0,65,0,7,48,0,1,1.13,75,13.3,90,8,385000,4.3,0.6,164,181,7.5,1.46,5,18.6,0,0,0,0], 
[1,0,1,1,0,1,1,1,0,0,0,0,0,0,0,0,1,44,0,7.5,0,2,1,2.14,94964,15.6,117.3,5200,118000,4.8,1.1,320,170,8.4,0.74,5,18,0,0,0,0], 
[1,1,1,0,0,0,1,1,0,0,0,0,0,0,0,1,1,52,50,6,0,0,1,1.79,44340,12.7,95.8,14.4,412000,2.2,28.5,444,462,6.6,3.95,5,8.5,19.8,0,0,0]
]'

insert_url = "https://cloud1.griddb.com/trial1602/griddb/v2/gs_clustertrial1602/dbs/r_blog/containers/HCC_Data4/rows/"  
r <- PUT(insert_url, 
         add_headers("Content-Type" = "application/json; charset=UTF-8" ) , 
		 config = authenticate("pratik", "pratik"), 
		 encode = "json" ,
		 body=HCC_Data4_JSON ) 

#To check if all rows have been inserted  
#print(r) 
print("Rows inserted")	  
#Fetch(Query) Only 2 columns are of interest, Alive( i.e. years alive after HCC) and Packs_of_cigarets_per_year (Packs of cigarretes per year) . 
my_sql_query1 = "SELECT Packs_of_cigarets_per_year, Alive FROM HCC_Data4 " 

#To retieve data from a GridDB container, the GridDB Web API Query URL must be suffied with "/sql" 
my_query_url = "https://cloud1.griddb.com/trial1602/griddb/v2/gs_clustertrial1602/dbs/r_blog/sql"

#Construct the request body  

query_request_body = ' [{"type":"sql-select" , "stmt":"SELECT Packs_of_cigarets_per_year, Alive FROM HCC_Data4" }] '

# print(query_request_body ) 
#Invoke the GridDB WebAPI request 
dataset <- POST ( my_query_url, 
       add_headers("Content-Type" = "application/json" ) ,      
       config = authenticate("pratik", "pratik"), 
       body = query_request_body 
       ) 
                             
#The data returned is now in dataset variable. 

# Simple Linear Regression 
# Splitting the dataset into the, Training_set and Test_set 
split = sample.split(dataset$Packs_of_cigarets_per_year, SplitRatio = 0.7) 
trainingset = subset(dataset, split == TRUE) 
testset = subset(dataset, split == FALSE) 

# Fitting Simple Linear Regression, to the Training set 
lm.r = lm(formula = Packs_of_cigarets_per_year~Alive, data = trainingset) 
# Just print the coefficient calculated, just to be sure that holds a logical value 
coef(lm.r) 
  
# Predicting the Test set results his lifestyle. 
# "ypred" function calculates the predicted probabilities at the values of the explanatory(independent) variable.
ypred = predict(lm.r, newdata = testset) 
#Now, the data frame testset has the predicted values of life expectancy OR Alive(how long can one expect to stay alive based on post HCC treatment lifestyle. 

#Lets visualize the results. 
trainingsetdf = data.frame( trainingset) 

# Visualising the Training set results  
x <- trainingsetdf$Packs_of_cigarets_per_year 
y <- trainingsetdf$Alive 
plot(x, y, main="Alive vs Packs_of_cigarets_per_year (Training set)", xlab="Packs Cigs", ylab="Alive")

# Next, based on the training , let the algorithm now predict the life expectancy in years. 
x <- testset$Packs_of_cigarets_per_year 
y <- testset$Alive 
plot(x, y, main="Predicted - Alive vs Packs_of_cigarets_per_year ", xlab="Packs Cigs", ylab="Alive") 

	
